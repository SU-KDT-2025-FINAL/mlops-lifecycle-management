# 🤖 AI SaaS 플랫폼 기술 사양 (Technical Specification)

본 문서는 '이커머스 SMB를 위한 AI 기반 예측 분석 플랫폼'의 성공적인 구축 및 운영을 위한 기술적 요구사항과 정책을 정의합니다.

## 📋 목차
1. [학습 데이터 스키마 정의 및 충분성 분석](#1-학습-데이터-스키마-정의-및-충분성-분석)
2. [모델 성능 및 정확도 관리 기준](#2-모델-성능-및-정확도-관리-기준)
3. [시스템 최소 요구사항](#3-시스템-최소-요구사항)
4. [정상 동작 바운더리 검사 및 추적](#4-정상-동작-바운더리-검사-및-추적)
5. [예측 이력 모니터링 및 인사이트](#5-예측-이력-모니터링--인사이트-정리)
6. [모델 및 프롬프트 버전 관리](#6-모델-및-프롬프트-버전-관리)
7. [예측 이상 발생 시 대응 계획](#7-예측-이상-발생-시-대응-계획)
8. [자동화된 워크플로우 (트리거 & 루틴)](#8-자동화된-워크플로우-트리거--루틴-정의)

---

## 1. 학습 데이터 스키마 정의 및 충분성 분석

### 1.1. 목표 정의
우리 AI 모델의 예측 목표는 다음과 같습니다.
1.  **고객 이탈 (Churn)**: 특정 기간 (e.g., 향후 3개월) 내에 고객이 재구매하지 않을 확률.
2.  **고객 생애 가치 (LTV)**: 고객이 미래에 창출할 총 예상 수익.

### 1.2. 데이터 소스 및 핵심 엔티티
- **주 데이터 소스**: 고객사의 이커머스 플랫폼(Shopify, Cafe24 등) API.
- **핵심 엔티티**: `Customers`, `Orders`, `Order Items`.

### 1.3. MVP를 위한 최소 필수 데이터 스키마
초기 MVP 단계에서는 RFM(Recency, Frequency, Monetary) 분석에 핵심적인 데이터만으로 모델을 구축합니다.

| 엔티티 | 필드명 (영문) | 데이터 타입 | 설명 | 예측 기여도 |
| :--- | :--- | :--- | :--- | :--- |
| **Customers** | `customer_id` | String | 고객 고유 ID (Primary Key) | 식별자 |
| | `created_at` | Datetime | 고객 가입일 | 고객의 활동 기간 분석 |
| **Orders** | `order_id` | String | 주문 고유 ID | 식별자 |
| | `customer_id` | String | 주문한 고객 ID (Foreign Key) | 고객-주문 연결 |
| | `created_at` | Datetime | 주문 발생 시각 | **Recency, Frequency** 계산 |
| | `total_price` | Numeric | 주문 총액 (할인, 배송비 포함) | **Monetary** 계산, LTV 예측 |
| | `financial_status` | String | 결제 상태 (e.g., paid, refunded) | 유효 주문 필터링 |

> **충분성 판단**: 위 스키마는 **RFM 분석**을 수행하기에 **충분하며**, MVP 단계에서 유의미한 예측 결과를 도출할 수 있습니다.

### 1.4. 서비스 고도화를 위한 이상적인 데이터 스키마 (확장 계획)
모델 정확도를 높이기 위해 다음과 같은 데이터를 추가로 수집할 수 있습니다.
- **Customers**: `city`, `country`, `tags`
- **Orders**: `discount_codes`, `shipping_address`
- **Order Items**: `product_id`, `quantity`, `price`
- **Products**: (별도 엔티티) `category`, `margin` 등

### 1.5. 데이터 품질 및 최소 요구사항 정의 (Onboarding Boundary)
모델이 유의미한 예측을 하기 위한 최소한의 데이터 조건이며, 신규 고객 온보딩 시 자동으로 검사합니다.

- **최소 고객 수**: **100명** 이상의 `Customers` 데이터
- **최소 주문 기간**: **6개월** 이상의 `Orders` 데이터
- **최소 주문 수**: 총 **200건** 이상의 `Orders` 데이터 (결제 완료 기준)

> **자동 검사 로직**: 사용자가 API 키를 연동하면, 백그라운드(`Celery Worker`)에서 위 조건을 만족하는지 자동으로 검사합니다. 조건을 충족하지 못하면, **"아직 분석을 위한 데이터가 부족합니다. 데이터가 더 쌓인 후 다시 시도해주세요."** 와 같은 안내 메시지를 표시해야 합니다.

### 1.6. 실행 계획
1.  **[1주차] API 명세 분석**: Shopify, Cafe24 API 문서를 분석하여 필수 스키마 필드를 매핑합니다.
2.  **[1-2주차] 데이터 커넥터 개발**: `Connector` 모듈에서 매핑된 필드의 데이터를 수집하고 정제하여 S3에 저장합니다.
3.  **[2주차] 데이터 유효성 검증 로직 구현**: '최소 요구사항'을 자동으로 검사하고, 결과에 따라 서비스 활성화 여부를 결정하는 로직을 구현합니다. 